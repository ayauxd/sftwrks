# Gitleaks configuration for secret detection
# Run: gitleaks detect --source . --config .gitleaks.toml

title = "Softworks Gitleaks Config"

[allowlist]
  description = "Allowlisted files"
  paths = [
    '''\.env\.example$''',
    '''node_modules''',
    '''dist/''',
  ]

[[rules]]
  id = "google-api-key"
  description = "Google API Key"
  regex = '''AIza[0-9A-Za-z\\-_]{35}'''
  tags = ["key", "google"]

[[rules]]
  id = "anthropic-api-key"
  description = "Anthropic API Key"
  regex = '''sk-ant-[a-zA-Z0-9-_]{90,}'''
  tags = ["key", "anthropic"]

[[rules]]
  id = "openai-api-key"
  description = "OpenAI API Key"
  regex = '''sk-[a-zA-Z0-9]{48}'''
  tags = ["key", "openai"]

[[rules]]
  id = "generic-secret"
  description = "Generic Secret Pattern"
  regex = '''(?i)(api[_-]?key|secret|password|token)\s*[:=]\s*['\"][a-zA-Z0-9+/=]{20,}['\"]'''
  tags = ["secret"]
